{{#partial "container"}}
<div class="issues-back">
  <a href="/" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon back-btn" title="go back" role="button">
    <i class="material-icons" role="presentation">arrow_back</i>
  </a>
</div>
{{#issueInfo}}
<div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">
	<div class="main_wrap mdl-grid">
		<h2 class="article_title">{{subject}}</h2>
		<div class="article_menu">
			<a href="/issue/{{id}}/modify" class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect">
			  <i class="material-icons">edit</i>
			</a>
			<a href="/issue/{{id}}/delete" id="issues-menu-lower-right" class="mdl-button mdl-js-button mdl-button--icon">
			  <i class="material-icons">delete</i>
			</a>
	    </div>
		<div class="article_container">		
			<div class="article">	    
			    <pre class="contents">{{contents}}</pre>
			</div>
			<div class="navigation">
			    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">
		          <img class="minilogo" height="48" width="48" src="https://avatars2.githubusercontent.com/u/520500?v=3&s=140" alt="javajigi"/>
			      <div style="margin-right:20px;">
			        <div class="author-text">
			          <strong>
			            <a href="/user/{{writer.id}}/detail" class="author">
			            	<strong class="writer_name">{{writer.userId}}</strong>
		            	</a>
			          </strong>
			        </div>
			        <span> {{writeDate}} </span>
			      </div>
		      	</div>
		      	<div class="nav_category">
		      		<div class="nav_title">State</div>
	   		      	<label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="switch-{{id}}">
					  <input type="checkbox" id="switch-{{id}}" value="{{id}}" class="mdl-switch__input" {{stateCheck}}>
					  <span class="mdl-switch__label"></span>
					</label>
					<span class="state">{{state}}</span>
		      	</div>
		      	<div class="nav_category">
			      	<div class="nav_title">Assignee</div>
			      	<button id="btn_add_assignee"
					        class="add_nav mdl-button mdl-js-button mdl-button--icon">
					  <i class="material-icons">record_voice_over</i>
					</button>
					<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect"
					    for="btn_add_assignee">
						{{#allUser}}
					 		<li class="mdl-menu__item">{{userId}}</li>
					  	{{/allUser}}
					</ul>
					{{#assigneeList}}
         			<span class="assignee mdl-chip mdl-chip--contact mdl-chip--deletable">
					    <img class="mdl-chip__contact" src="https://avatars2.githubusercontent.com/u/520500?v=3&s=140"></img>
					    <span class="mdl-chip__text">{{userId}}</span>
					    <a href="#" class="mdl-chip__action"><i class="material-icons">cancel</i></a>
					</span>
					{{/assigneeList}}
		      	</div>
		      	<div class="nav_category">
		      		<div class="nav_title">Milestone</div>
			      	<button id="btn_add_milestone"
					        class="add_nav mdl-button mdl-js-button mdl-button--icon">
					  <i class="material-icons">settings</i>
					</button>
					<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect"
					    for="btn_add_milestone">
						{{#allMilestone}}
					 		<li class="mdl-menu__item">{{subject}}</li>
					  	{{/allMilestone}}
					</ul>
		      		<a href="/milestone/{{milestone.id}}/detail"><strong>{{milestone.subject}}</strong></a>
		      	</div>
		      	<div class="nav_category">
		      		<div class="nav_title">Label</div>
						<button id="btn_add_label"
					    	    class="add_nav mdl-button mdl-js-button mdl-button--icon">
					  	<i class="material-icons">label</i>
					</button>
					<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect"
					    for="btn_add_label">
						{{#each allLabel}}
					 		<li class="mdl-menu__item">{{name}}</li>
					  	{{/each}}
					</ul>
		      		{{#each labelList}}
					<span id="label_{{id}}" class="label mdl-chip mdl-chip--deletable" style="background-color:{{color}}">
					    <span class="mdl-chip__text">{{name}}</span>
					    <button type="button" class="mdl-chip__action"><i class="material-icons">cancel</i></button>
					</span>
					{{/each}}
		      	</div>
			</div>
		</div>
	</div>
	<div class="comment-form mdl-color-text--primary-contrast mdl-card__supporting-text comments">
	{{#each commentList}}
	 	<div id="comment_{{id}}" class="comment_container">
			<img class="comment_thumb minilogo" height="48" width="48" src="https://avatars2.githubusercontent.com/u/520500?v=3&amp;s=140" alt="javajigi">
			<div class="comment_info">
	    		<a class="comment_user" href="/user/{{writer.id}}/detail">{{writer.userId}}</a>        
	  			<span class="comment_date">{{formattedWriteDate}}</span>
		        	{{#if isMyComment}}
		        		<a id="btn_modify_{{id}}" class="btn_comment_modify" onclick="openCommentForm({{id}}, '{{contents}}')">수정</a>            			
		        		<a class="btn_comment_delete" onclick="delComment({{id}})">삭제</a>
		     		{{/if}}
		     	<div id="comment_contents_{{id}}" class="comment_contents">
			  		{{contents}}        	
				</div>
 			</div>
			<hr>
		</div>
    {{/each}}
	</div>
	<form action="/issue/1/uploadFile" enctype="multipart/form-data" method="POST">
		<div style="margin:10px;">
		  <input type="file" name="file" id="file" />
		  <button class="mdl-button" type="submit">upload file</button>
		</div>
	</form>
	<div class="mdl-color-text--primary-contrast mdl-card__supporting-text new-comment">
		<form class="comment-create" action="/comment/{{id}}/new" method="POST">
		  <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
		    <textarea row=5 class="mdl-textfield__input" id="contents" name="contents"></textarea>
		    <label for="contents" class="mdl-textfield__label">Leave a comment</label>
		  </div>
		  <a class="btn_comment_complete add-comment-btn mdl-js-button mdl-js-ripple-effect mdl-button--icon">
		    <i class="material-icons" role="presentation">check</i><span class="visuallyhidden">add comment</span>
		  </a>
		</form>
	</div>
</div>
{{/issueInfo}}
{{/partial}}
{{> template}}
<script type="text/template" id="commentTemplate">
<div id="comment_{0}" class="comment_container">
	<img class="comment_thumb minilogo" height="48" width="48" src="https://avatars2.githubusercontent.com/u/520500?v=3&amp;s=140" alt="javajigi">
	<div class="comment_info">
		<a class="comment_user" href="/user/{3}/detail">{4}</a>        
	  	<span class="comment_date">{2}</span>
		{{#if 5}}
		 	<a id="btn_modify_{0}" class="btn_comment_modify" onclick="openCommentForm({0}, '{1}')">수정</a>            			
		    <a class="btn_comment_delete" onclick="delComment({0})">삭제</a>
		{{/if}}
		<div id="comment_contents_{0}" class="comment_contents">
			{1}        	
		</div>
 	</div>
	<hr>
</div>
</script>

<script type="text/template" id="comment_input_template">
  	<div id="comment_input" class="comment_input_wrap" data-id="{0}">
  		<textarea class="comment_input">{1}</textarea>
  		<a class="btn_comment_complete mdl-js-button mdl-js-ripple-effect mdl-button--icon"
		   data-id="{0}" data-upgraded=",MaterialButton,MaterialRipple"
		   onclick="modifyComment({0})">
	   		<i class="material-icons" role="presentation">check</i><span class="visuallyhidden">add comment</span>
	    	<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span>
  		</a>
	</div>  
</script>

<script id="test-template" type="text/x-handlebars-template">
    <div class="mdl-color-text--grey-700 mdl-card__supporting-text">
      <p>{{contents}}</p>
	</div>
</script>
<script>
    	//var source = $("#test-template").html();
    	//var template = Handlebars.compile(source);
</script>
